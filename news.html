<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vasai Live News</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background:#f6f7fb;color:#0b2540;font-family:Arial,sans-serif;margin:0;}
/* Header */
header{display:flex;align-items:center;justify-between;padding:10px 16px;background:#1e40af;color:white;flex-wrap:wrap;}
.header-left{display:flex;align-items:center;gap:10px;}
.header-left img{height:50px;width:50px;border-radius:8px;}
.header-left h1{font-weight:800;font-size:22px;text-shadow:2px 2px 4px rgba(0,0,0,0.4);}
.header-buttons{display:flex;gap:6px;flex-wrap:wrap;}
.header-buttons button{padding:4px 8px;font-size:12px;border-radius:6px;font-weight:bold;cursor:pointer;transform: perspective(500px) rotateX(8deg) rotateY(-5deg);box-shadow:2px 2px 5px rgba(0,0,0,0.3);}
.ticker{background:#1e40af;color:white;padding:6px;overflow:hidden;white-space:nowrap;margin-bottom:6px;}
.ticker span{display:inline-block;padding-right:50px;animation:scroll 15s linear infinite;}
@keyframes scroll{0%{transform:translateX(100%);}100%{transform:translateX(-100%);}}
.category-btns{display:flex;gap:6px;overflow-x:auto;margin-bottom:12px;padding:0 4px;}
.category-btns button{flex-shrink:0;padding:3px 6px;border-radius:6px;border:1px solid #3b82f6;color:#3b82f6;cursor:pointer;font-size:12px;}
.category-btns button.active{background:#3b82f6;color:white;}
.card{background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 6px 20px rgba(2,6,23,0.06);padding:12px;margin-bottom:12px;cursor:pointer;}
.card img{width:100%;border-radius:6px;margin-bottom:6px;}
.card h3{font-weight:700;margin-bottom:4px;font-size:18px;}
.card .meta{font-size:12px;color:#6b7280;margin-bottom:6px;}
.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:50;}
.modal{background:#fff;border-radius:10px;max-width:500px;width:90%;max-height:80%;overflow-y:auto;padding:16px;position:relative;}
.modal-close{position:absolute;top:8px;right:8px;background:#f87171;color:white;border:none;border-radius:4px;padding:2px 6px;cursor:pointer;}
textarea{resize:none;}
.social-share{display:flex;gap:6px;margin-top:8px;}
.social-share button{flex:1;padding:4px;border-radius:6px;border:1px solid #3b82f6;color:#3b82f6;font-size:12px;}
</style>
</head>
<body class="p-2">

<header>
  <div class="header-left">
    <img id="logoImg" src="YOUR_PC_LOGO_PATH" alt="Logo">
    <h1>Vasai Live News</h1>
  </div>
  <div class="header-buttons">
    <button id="loginBtn" class="bg-green-500 text-white">Admin Login</button>
    <button id="logoutBtn" class="hidden bg-red-600 text-white">Logout</button>
    <button class="bg-yellow-400">About</button>
    <button class="bg-orange-400">Contact</button>
  </div>
</header>

<!-- Scrolling Ticker -->
<div class="ticker"><span id="tickerText">Loading latest news...</span></div>

<!-- Admin ticker editor -->
<section id="tickerEditor" class="hidden p-2 mb-4 bg-white rounded shadow">
  <h2 class="font-semibold mb-2">Edit Scrolling Text (Ticker)</h2>
  <input id="tickerInput" class="border p-2 w-full mb-2 rounded" placeholder="Enter ticker text">
  <button id="saveTickerBtn" class="bg-blue-700 text-white px-4 py-2 rounded">Save Ticker</button>
</section>

<!-- Category Buttons -->
<div class="category-btns" id="categoryBtns"></div>

<!-- Admin Post Editor -->
<section id="editorArea" class="hidden p-2 mb-4 bg-white rounded shadow">
  <h2 class="font-semibold mb-2">Create / Edit Post</h2>
  <input id="aTitle" class="border p-2 w-full mb-2 rounded" placeholder="Title">
  <input id="aCat" class="border p-2 w-full mb-2 rounded" placeholder="Category">
  <div class="flex gap-2 mb-2">
    <button id="addTextBtn" class="bg-gray-200 px-3 py-1 rounded">Add Text</button>
    <button id="addImageBtn" class="bg-gray-200 px-3 py-1 rounded">Add Image</button>
  </div>
  <div id="blocksList" class="mb-3"></div>
  <div class="flex gap-2">
    <button id="publishBtn" class="bg-blue-700 text-white px-4 py-2 rounded">Publish</button>
    <button id="clearBtn" class="bg-gray-200 px-4 py-2 rounded">Clear</button>
  </div>
</section>

<!-- Posts Area -->
<section id="postsArea"></section>

<!-- Modal -->
<div id="modalBg" class="modal-bg flex">
  <div class="modal">
    <button id="modalClose" class="modal-close">X</button>
    <div id="modalContent"></div>
  </div>
</div>

<script type="module">
// Firebase imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, doc, updateDoc, deleteDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDMvkPqFKDjrMaLlBkercBYoLxEs1GEbng",
  authDomain: "all-madrsa.firebaseapp.com",
  projectId: "all-madrsa",
  storageBucket: "all-madrsa.appspot.com",
  messagingSenderId: "619313835874",
  appId: "1:619313835874:web:312ec03e62fd49d3d92e60"
};
const IMGBB_API_KEY="c4bc97c133edb76e062de6d070df67e4";
const ADMIN_EMAIL="zaradigitalseva@gmail.com";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginBtn=document.getElementById("loginBtn");
const logoutBtn=document.getElementById("logoutBtn");
const editorArea=document.getElementById("editorArea");
const tickerEditor=document.getElementById("tickerEditor");
const tickerText=document.getElementById("tickerText");
const tickerInput=document.getElementById("tickerInput");
const saveTickerBtn=document.getElementById("saveTickerBtn");
const blocksList=document.getElementById("blocksList");
const postsArea=document.getElementById("postsArea");
const aTitle=document.getElementById("aTitle");
const aCat=document.getElementById("aCat");
const publishBtn=document.getElementById("publishBtn");
const clearBtn=document.getElementById("clearBtn");
const modalBg=document.getElementById("modalBg");
const modalContent=document.getElementById("modalContent");
const modalClose=document.getElementById("modalClose");
const categoryBtns=document.getElementById("categoryBtns");

let editingId=null;
let currentCategory=null;

// Login/Logout
loginBtn.onclick=async()=>{try{await signInWithPopup(auth,new GoogleAuthProvider());}catch(e){alert("Login failed"); console.error(e);}};
logoutBtn.onclick=async()=>await signOut(auth);

onAuthStateChanged(auth,user=>{
  if(user && user.email===ADMIN_EMAIL){
    loginBtn.classList.add("hidden");
    logoutBtn.classList.remove("hidden");
    editorArea.classList.remove("hidden");
    tickerEditor.classList.remove("hidden");
  } else {
    loginBtn.classList.remove("hidden");
    logoutBtn.classList.add("hidden");
    editorArea.classList.add("hidden");
    tickerEditor.classList.add("hidden");
  }
  loadPosts(); loadTicker();
});

// Ticker
async function loadTicker(){
  const docSnap=await getDocs(collection(db,"ticker"));
  if(!docSnap.empty){ docSnap.forEach(docu=>{tickerText.innerHTML=docu.data().text;tickerInput.value=docu.data().text;}); }
}
saveTickerBtn.onclick=async()=>{
  const text=tickerInput.value.trim();
  if(!text) return alert("Enter ticker text");
  await setDoc(doc(db,"ticker","main"),{text});
  tickerText.innerHTML=text; alert("Ticker updated!");
};

// Add Blocks
document.getElementById("addTextBtn").onclick=()=>{
  const t=document.createElement("textarea"); t.className="border w-full p-2 rounded mt-2"; t.placeholder="Text..."; blocksList.appendChild(t);
};
document.getElementById("addImageBtn").onclick=()=>{
  const div=document.createElement("div"); div.className="mt-2";
  const inputFile=document.createElement("input"); inputFile.type="file"; inputFile.accept="image/*"; inputFile.className="border p-1 rounded w-full";
  const urlInput=document.createElement("input"); urlInput.type="text"; urlInput.placeholder="Uploaded URL"; urlInput.className="border p-1 rounded w-full mt-1";
  div.appendChild(inputFile); div.appendChild(urlInput); blocksList.appendChild(div);
  inputFile.addEventListener("change",async()=>{
    if(!inputFile.files.length) return;
    const file=inputFile.files[0];
    const form=new FormData(); form.append("image",file);
    try{
      const res=await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`,{method:"POST",body:form});
      const data=await res.json(); if(data.success){urlInput.value=data.data.url;alert("Image uploaded");}else throw new Error("Upload failed");
    }catch(e){alert("Upload failed");console.error(e);}
  });
};

// Publish/Clear/Post Loading etc same as previous code
// ... [Yeh part mai pehle ke code se copy kar do] ...
</script>
</body>
</html>
