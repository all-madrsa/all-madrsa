<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vasai Live News</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background:#f6f7fb;color:#0b2540;font-family:Arial,sans-serif;}
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  background:#1e40af;
  color:white;
  border-radius:6px;
  margin-bottom:6px;
}
header .logo-text{
  font-weight:900;
  font-size:22px;
  color:#fff;
  text-shadow:
     2px 2px 0 #1f2937,
     4px 4px 0 #3b82f6,
     6px 6px 0 #60a5fa;
}
header img{
  height:40px;
  width:40px;
  border-radius:6px;
  margin-right:8px;
}
.card{background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 6px 20px rgba(2,6,23,0.06);padding:12px;margin-bottom:12px;cursor:pointer;}
.card img{width:100%;border-radius:6px;margin-bottom:6px;}
.card h3{font-weight:700;margin-bottom:4px;font-size:18px;}
.card .meta{font-size:12px;color:#6b7280;margin-bottom:6px;}
.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:50;}
.modal{background:#fff;border-radius:10px;max-width:500px;width:90%;max-height:80%;overflow-y:auto;padding:16px;position:relative;}
.modal-close{position:absolute;top:8px;right:8px;background:#f87171;color:white;border:none;border-radius:4px;padding:2px 6px;cursor:pointer;}
textarea{resize:none;}
.ticker{background:#1e40af;color:white;padding:6px;overflow:hidden;white-space:nowrap;margin-bottom:6px;}
.ticker span{display:inline-block;padding-right:50px;animation:scroll 15s linear infinite;}
@keyframes scroll{0%{transform:translateX(100%);}100%{transform:translateX(-100%);}}
.category-btns{display:flex;gap:6px;overflow-x:auto;margin-bottom:12px;}
.category-btns button{flex-shrink:0;padding:4px 8px;border-radius:6px;border:1px solid #3b82f6;color:#3b82f6;cursor:pointer;}
.category-btns button.active{background:#3b82f6;color:white;}
.social-share{display:flex;gap:6px;margin-top:8px;}
.social-share button{flex:1;padding:4px;border-radius:6px;border:1px solid #3b82f6;color:#3b82f6;font-size:12px;}
</style>
</head>
<body class="p-2">

<header>
  <div class="flex items-center">
    <img id="logoImg" src="" alt="Logo">
    <div class="logo-text">Vasai Live News</div>
  </div>
  <div>
    <button id="loginBtn" class="bg-blue-700 text-white px-3 py-1 rounded">Admin Login</button>
    <button id="logoutBtn" class="hidden bg-red-600 text-white px-3 py-1 rounded">Logout</button>
  </div>
</header>

<!-- SCROLLING TEXT (Ticker) -->
<div class="ticker">
  <span id="tickerText">Loading latest news...</span>
</div>

<!-- ADMIN SCROLLING TEXT EDITOR -->
<section id="tickerEditor" class="hidden mb-2">
  <input id="tickerInput" class="border p-2 w-full rounded" placeholder="Enter scrolling text for header">
  <button id="saveTicker" class="bg-blue-700 text-white px-3 py-1 rounded mt-1">Save</button>
</section>

<!-- CATEGORY FILTER -->
<div class="category-btns" id="categoryBtns"></div>

<!-- ADMIN POST PANEL -->
<section id="editorArea" class="hidden p-2 mb-4 bg-white rounded shadow">
  <h2 class="font-semibold mb-2">Create / Edit Post</h2>
  <input id="aTitle" class="border p-2 w-full mb-2 rounded" placeholder="Title">
  <input id="aCat" class="border p-2 w-full mb-2 rounded" placeholder="Category">
  
  <div class="flex gap-2 mb-2">
    <button id="addTextBtn" class="bg-gray-200 px-3 py-1 rounded">Add Text</button>
    <button id="addImageBtn" class="bg-gray-200 px-3 py-1 rounded">Add Image</button>
  </div>
  <div id="blocksList" class="mb-3"></div>
  
  <div class="flex gap-2">
    <button id="publishBtn" class="bg-blue-700 text-white px-4 py-2 rounded">Publish</button>
    <button id="clearBtn" class="bg-gray-200 px-4 py-2 rounded">Clear</button>
  </div>
</section>

<!-- POSTS LIST -->
<section id="postsArea"></section>

<!-- MODAL -->
<div id="modalBg" class="modal-bg flex">
  <div class="modal">
    <button id="modalClose" class="modal-close">X</button>
    <div id="modalContent"></div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDMvkPqFKDjrMaLlBkercBYoLxEs1GEbng",
  authDomain: "all-madrsa.firebaseapp.com",
  projectId: "all-madrsa",
  storageBucket: "all-madrsa.appspot.com",
  messagingSenderId: "619313835874",
  appId: "1:619313835874:web:312ec03e62fd49d3d92e60"
};

const IMGBB_API_KEY = "c4bc97c133edb76e062de6d070df67e4";
const ADMIN_EMAIL = "zaradigitalseva@gmail.com";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const editorArea = document.getElementById("editorArea");
const blocksList = document.getElementById("blocksList");
const postsArea = document.getElementById("postsArea");
const aTitle = document.getElementById("aTitle");
const aCat = document.getElementById("aCat");
const publishBtn = document.getElementById("publishBtn");
const clearBtn = document.getElementById("clearBtn");
const modalBg = document.getElementById("modalBg");
const modalContent = document.getElementById("modalContent");
const modalClose = document.getElementById("modalClose");
const categoryBtns = document.getElementById("categoryBtns");
const tickerText = document.getElementById("tickerText");
const tickerEditor = document.getElementById("tickerEditor");
const tickerInput = document.getElementById("tickerInput");
const saveTicker = document.getElementById("saveTicker");
const logoImg = document.getElementById("logoImg");

let editingId = null;
let currentCategory = null;

// FIXED LOGO - user can set manually
logoImg.src = "https://i.ibb.co/7vYrGfz/vasai-logo.png"; // yaha apna logo ka link

// LOGIN / LOGOUT
loginBtn.onclick = async () => {
  const provider = new GoogleAuthProvider();
  try { await signInWithPopup(auth, provider); } catch(e){ alert("Login failed"); console.error(e);}
};
logoutBtn.onclick = async ()=>await signOut(auth);

// AUTH STATE
onAuthStateChanged(auth,user=>{
  if(user && user.email===ADMIN_EMAIL){
    loginBtn.classList.add("hidden");
    logoutBtn.classList.remove("hidden");
    editorArea.classList.remove("hidden");
    tickerEditor.classList.remove("hidden");
  } else {
    loginBtn.classList.remove("hidden");
    logoutBtn.classList.add("hidden");
    editorArea.classList.add("hidden");
    tickerEditor.classList.add("hidden");
  }
  loadPosts();
});

// SCROLLING TEXT SAVE
saveTicker.onclick = async () => {
  const text = tickerInput.value.trim();
  if(!text) return alert("Enter text");
  localStorage.setItem("tickerText", text);
  tickerText.textContent = text;
  alert("Scrolling text updated");
};

// Load ticker text on page load
if(localStorage.getItem("tickerText")){
  tickerText.textContent = localStorage.getItem("tickerText");
}

// The rest of the code for posts (add/edit/delete, modal) same as previous version

</script>
</body>
</html>
