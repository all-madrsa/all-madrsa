<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nikah Profile</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f4f4f4;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background: #008069;
      color: #fff;
    }
    header h1 {
      font-size: 20px;
    }
    header button {
      background: #fff;
      color: #008069;
      border: none;
      padding: 6px 12px;
      cursor: pointer;
      border-radius: 4px;
    }
    #form-section {
      background: #fff;
      padding: 15px;
      margin: 15px;
      border-radius: 6px;
      display: none; /* ‡§ï‡•á‡§µ‡§≤ admin ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ */
    }
    #form-section input {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
      box-sizing: border-box;
    }
    #members-list {
      display: grid;
      gap: 1rem;
      padding: 15px;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    @media (min-width: 768px) {
      #members-list {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    @media (min-width: 1024px) {
      #members-list {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    .member-card {
      background: #fff;
      border-radius: 6px;
      padding: 10px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .member-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 6px;
    }
    .member-card h3 {
      margin: 8px 0 4px;
    }
    .whatsapp-btn {
      display: inline-block;
      margin-top: 6px;
      padding: 6px 12px;
      background: #25D366;
      color: #fff;
      text-decoration: none;
      border-radius: 4px;
    }
    .admin-btn {
      margin: 5px 3px 0;
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .edit-btn {
      background: #ffa500;
      color: #fff;
    }
    .delete-btn {
      background: #d9534f;
      color: #fff;
    }
  </style>
</head>
<body>

<header>
  <h1>Nikah Profiles</h1>
  <div>
    <button id="login-btn" onclick="login()">Login as Admin</button>
    <button id="logout-btn" onclick="logout()" style="display:none;">Logout</button>
  </div>
</header>

<!-- Admin Add Form -->
<section id="form-section">
  <h3>Add New Profile</h3>
  <input type="text" id="name" placeholder="Name" required>
  <input type="number" id="age" placeholder="Age" required>
  <input type="text" id="city" placeholder="City" required>
  <input type="file" id="photo" accept="image/*" required>
  <button onclick="addMember()">Add Profile</button>
</section>

<!-- Profiles -->
<section id="members-list"></section>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<script>
  // üî∏ ‡§Ö‡§™‡§®‡•Ä Firebase config ‡§°‡§æ‡§≤‡•á‡§Ç
  const firebaseConfig = {
    apiKey: "YOUR_FIREBASE_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MSG_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const auth = firebase.auth();

  const adminEmails = ["youremail@gmail.com"]; // üî∏ ‡§Ö‡§™‡§®‡§æ Admin Email ‡§°‡§æ‡§≤‡•á‡§Ç
  let currentUser = null;

  auth.onAuthStateChanged(user => {
    currentUser = user;
    if (user && adminEmails.includes(user.email)) {
      document.getElementById('form-section').style.display = 'block';
      document.getElementById('login-btn').style.display = 'none';
      document.getElementById('logout-btn').style.display = 'inline-block';
    } else {
      document.getElementById('form-section').style.display = 'none';
      document.getElementById('login-btn').style.display = 'inline-block';
      document.getElementById('logout-btn').style.display = 'none';
    }
    loadMembers();
  });

  function login() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider);
  }
  function logout() {
    auth.signOut();
  }

  async function addMember() {
    const name = document.getElementById('name').value;
    const age = document.getElementById('age').value;
    const city = document.getElementById('city').value;
    const photo = document.getElementById('photo').files[0];

    if (!name || !age || !city || !photo) return alert('Please fill all fields');

    // üî∏ imgbb Image Upload
    const formData = new FormData();
    formData.append("image", photo);
    const res = await fetch("https://api.imgbb.com/1/upload?key=YOUR_IMGBB_KEY", {
      method: "POST",
      body: formData
    });
    const result = await res.json();
    const photoURL = result.data.url;

    await db.collection("members").add({ name, age, city, photoURL });
    alert("Profile Added ‚úÖ");
    document.getElementById('name').value = '';
    document.getElementById('age').value = '';
    document.getElementById('city').value = '';
    document.getElementById('photo').value = '';
  }

  function loadMembers() {
    const list = document.getElementById('members-list');
    list.innerHTML = '';
    db.collection("members").onSnapshot(snapshot => {
      list.innerHTML = '';
      snapshot.forEach(doc => renderCard(doc));
    });
  }

  function renderCard(doc) {
    const d = doc.data();
    const div = document.createElement('div');
    div.className = 'member-card';
    div.innerHTML = `
      <img src="${d.photoURL}" alt="${d.name}">
      <h3>${d.name}</h3>
      <p>Age: ${d.age}</p>
      <p>City: ${d.city}</p>
      <a class="whatsapp-btn" href="https://wa.me/91XXXXXXXXXX?text=Mujhe%20${encodeURIComponent(d.name)}%20ki%20profile%20mein%20interest%20hai" target="_blank">WhatsApp</a>
    `;

    // ‚úÖ ‡§Ö‡§ó‡§∞ admin ‡§π‡•à ‡§§‡•ã edit/delete ‡§¶‡§ø‡§ñ‡§æ‡§ì
    if (currentUser && adminEmails.includes(currentUser.email)) {
      const editBtn = document.createElement('button');
      editBtn.textContent = '‚úè Edit';
      editBtn.className = 'admin-btn edit-btn';
      editBtn.onclick = () => editMember(doc.id, d);

      const delBtn = document.createElement('button');
      delBtn.textContent = 'üóë Delete';
      delBtn.className = 'admin-btn delete-btn';
      delBtn.onclick = () => deleteMember(doc.id);

      div.appendChild(editBtn);
      div.appendChild(delBtn);
    }

    document.getElementById('members-list').appendChild(div);
  }

  function editMember(id, data) {
    const newName = prompt("Edit Name", data.name);
    if (newName) {
      db.collection("members").doc(id).update({ name: newName });
    }
  }

  function deleteMember(id) {
    if (confirm("Are you sure to delete this profile?")) {
      db.collection("members").doc(id).delete();
    }
  }
</script>

</body>
</html>
