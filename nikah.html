<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nikah Portal | Shadi.com Style</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js"></script>

<style>
  body { font-family: 'Inter', sans-serif; background: #f8fafc; }
  header { position: sticky; top: 0; z-index: 20; backdrop-filter: blur(10px); background: rgba(255,255,255,0.8); }
  .profile-card { transition: all 0.3s ease; }
  .profile-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
  .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 50; }
  .modal-content { background: white; border-radius: 1rem; max-width: 500px; width: 90%; padding: 20px; }
</style>
</head>
<body>

<!-- HEADER -->
<header class="p-4 shadow">
  <div class="max-w-6xl mx-auto flex justify-between items-center">
    <h1 class="text-2xl font-bold text-green-700">üíç Nikah Portal</h1>
    <button id="adminBtn" class="bg-green-600 text-white px-4 py-1 rounded-lg text-sm hover:bg-green-700">Admin Login</button>
  </div>
</header>

<!-- HERO -->
<section class="relative bg-gradient-to-r from-green-50 to-white rounded-lg shadow p-8 mt-4 mx-4 max-w-6xl mx-auto overflow-hidden">
  <img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e" class="absolute inset-0 w-full h-full object-cover opacity-10" />
  <div class="relative">
    <h2 class="text-3xl font-bold text-green-800">Find Your Perfect Match</h2>
    <p class="text-gray-600 mt-2">Trusted matrimonial portal inspired by Shadi.com</p>
  </div>
</section>

<!-- FILTER -->
<div class="max-w-6xl mx-auto mt-6 bg-white p-4 rounded-lg shadow flex flex-wrap gap-3 items-center">
  <input id="filterName" type="text" placeholder="Search by name/city" class="border p-2 rounded flex-1">
  <select id="filterGender" class="border p-2 rounded">
    <option value="">All</option>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
  </select>
  <button id="filterBtn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Search</button>
  <button id="postBtn" class="ml-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Post Profile</button>
</div>

<!-- PROFILES -->
<div id="profilesGrid" class="max-w-6xl mx-auto grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4 mt-4"></div>

<!-- ADMIN DASHBOARD -->
<div id="adminPanel" class="hidden max-w-6xl mx-auto bg-white shadow rounded-lg mt-6 p-4">
  <h3 class="text-xl font-semibold mb-3 text-green-700">Admin Dashboard</h3>
  <ul id="adminList" class="space-y-2"></ul>
</div>

<!-- PROFILE MODAL -->
<div id="profileModal" class="modal-bg">
  <div class="modal-content">
    <button id="closeModal" class="float-right text-red-600">‚úñ</button>
    <img id="modalImg" class="rounded-lg w-full h-60 object-cover mt-2" />
    <h3 id="modalName" class="text-xl font-bold mt-3"></h3>
    <p id="modalInfo" class="text-gray-600"></p>
    <p id="modalDesc" class="mt-2 text-sm"></p>
  </div>
</div>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyDMvkPqFKDjrMaLlBkercBYoLxEs1GEbng",
  authDomain: "all-madrsa.firebaseapp.com",
  projectId: "all-madrsa",
  storageBucket: "all-madrsa.appspot.com",
  messagingSenderId: "619313835874",
  appId: "1:619313835874:web:e387e1297663f11fc2463b"
};
const IMG_API_KEY = "d12c2e4a8650157b2b6b9fe85336ea43";

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

// Elements
const profilesGrid = document.getElementById('profilesGrid');
const profileModal = document.getElementById('profileModal');
const closeModal = document.getElementById('closeModal');
const modalImg = document.getElementById('modalImg');
const modalName = document.getElementById('modalName');
const modalInfo = document.getElementById('modalInfo');
const modalDesc = document.getElementById('modalDesc');

// Fetch Approved Profiles
async function loadProfiles() {
  profilesGrid.innerHTML = "Loading...";
  const snap = await db.collection('profiles').where('approved', '==', true).get();
  profilesGrid.innerHTML = "";
  snap.forEach(doc=>{
    const d = doc.data();
    const card = document.createElement('div');
    card.className = "profile-card bg-white rounded-lg shadow overflow-hidden cursor-pointer";
    card.innerHTML = `
      <img src="${d.imageUrl}" class="w-full h-48 object-cover">
      <div class="p-3">
        <h4 class="font-semibold">${d.name}, ${d.age}</h4>
        <p class="text-sm text-gray-500">${d.city} ¬∑ ${d.gender}</p>
      </div>
    `;
    card.onclick = ()=>showModal(d);
    profilesGrid.appendChild(card);
  });
}

function showModal(d){
  modalImg.src = d.imageUrl;
  modalName.textContent = d.name;
  modalInfo.textContent = `${d.age} ¬∑ ${d.city} ¬∑ ${d.gender}`;
  modalDesc.textContent = d.about || '';
  profileModal.style.display = "flex";
}
closeModal.onclick = ()=>profileModal.style.display="none";
loadProfiles();

// Filter
document.getElementById('filterBtn').addEventListener('click', async ()=>{
  const name = document.getElementById('filterName').value.trim().toLowerCase();
  const gender = document.getElementById('filterGender').value;
  const q = db.collection('profiles').where('approved','==', true);
  const snap = await q.get();
  profilesGrid.innerHTML = "";
  snap.forEach(doc=>{
    const d = doc.data();
    if((!name || d.name.toLowerCase().includes(name) || d.city.toLowerCase().includes(name)) &&
       (!gender || d.gender === gender)){
        const card = document.createElement('div');
        card.className="profile-card bg-white rounded-lg shadow overflow-hidden cursor-pointer";
        card.innerHTML=`
          <img src="${d.imageUrl}" class="w-full h-48 object-cover">
          <div class="p-3">
            <h4 class="font-semibold">${d.name}, ${d.age}</h4>
            <p class="text-sm text-gray-500">${d.city} ¬∑ ${d.gender}</p>
          </div>`;
        card.onclick = ()=>showModal(d);
        profilesGrid.appendChild(card);
    }
  });
});

</script>
</body>
</html>
