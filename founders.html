<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>All Members List | All India Muslim Personal Board</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f8f9fa; }

    <!-- Header with Logo and 3D Buttons -->
<header class="bg-blue-600" style="height:100px;"> <!-- header height thoda kam kiya -->
  <div class="max-w-6xl mx-auto px-4 py-2 h-full flex flex-col justify-between">

    <!-- Top: 3D Buttons -->
   <div class="flex justify-center gap-4">
  <a href="nikah.html">
    <button class="btn-3d-special btn-small" style="background: linear-gradient(90deg,#ff4d4d,#ff914d);">ğŸ’ Nikah</button>
  </a>
  <a href="news.html">
    <button class="btn-3d-special btn-small" style="background: linear-gradient(90deg,#4dffb8,#4d94ff);">ğŸ“° News</button>
  </a>
  <a href="hadees.html">
    <button class="btn-3d-special btn-small" style="background: linear-gradient(90deg,#d24dff,#ff4dd2);">ğŸ“œ Hadees</button>
  </a>
</div>


    <!-- Middle: Logo and Side Images -->
    <div class="flex justify-between items-center h-full mt-1">

      <!-- Left: Makka -->
      <div class="flex items-center">
        <img src="makka.png" alt="Makka" class="header-png">
      </div>

    <!-- Center: Logo / Title -->
<div class="flex flex-col items-center justify-center h-full">
  <div class="text-white font-bold text-2xl" 
       style="text-shadow:2px 2px 8px rgba(0,0,0,.9); transform: translateY(-8px);">
     My Document
  </div>
</div>


      <!-- Right: Madina -->
      <div class="flex items-center">
        <img src="madina.png" alt="Madina" class="header-png">
      </div>

    </div>
  </div>
</header>

<style>
/* 3D Buttons Base */
.btn-3d-special {
  color: #fff;
  font-weight: 700;
  border-radius: 10px;
  box-shadow: 0 6px 0 rgba(0,0,0,.25), 0 8px 14px rgba(0,0,0,.25);
  transition: transform .12s ease, box-shadow .12s ease;
}
.btn-3d-special:active {
  transform: translateY(3px);
  box-shadow: 0 3px 0 rgba(0,0,0,.25);
}

/* Small variant for top header buttons */
.btn-small {
  font-size: 0.85rem;
  padding: 0.4rem 0.9rem;
}

/* Header PNG images */
.header-png {
  height: 70px;           /* image height */
  width: 70px;            /* image width */
  object-fit: cover;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>




  

   
  <!-- Left: Home Button -->
  <div>
 <a href="index.html" class="btn-3d-home px-1 py-0.5 text-xs rounded font-bold flex items-center justify-center">
  ğŸ  Home
</a>

  


<style>
/* 3D Button Style */
.btn-3d-home {
  background: linear-gradient(90deg,#ff4d4d,#4d94ff);
  color: white;
  font-weight: 700;
  box-shadow: 0 6px 0 rgba(0,0,0,0.25), 0 8px 14px rgba(0,0,0,0.25);
  transition: transform 0.1s ease, box-shadow 0.1s ease;
}
.btn-3d-home:active {
  transform: translateY(3px);
  box-shadow: 0 3px 0 rgba(0,0,0,0.25);
}
</style>
<body>

<header>
  <a href="index.html" class="home-btn">ğŸ </a>
  <h1>All Members List</h1>
</header>

<main>
  <div id="members"></div>
  <p id="msg"></p>

  <form id="memberForm">
    <h3>Add Member</h3>
    <input type="text" id="name" placeholder="Member Name" required>
    <input type="file" id="photoFile" accept="image/*" required>
    <button type="button" onclick="addMember()">Add Member</button>
  </form>
</main>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDMvkPqFKDjrMaLlBkercBYoLxEs1GEbng",
    authDomain: "all-madrasa.firebaseapp.com",
    projectId: "all-madrsa",
    storageBucket: "all-madrsa.appspot.com",
    messagingSenderId: "619313835874",
    appId: "1:619313835874:web:e387e1297663f11fc2463b"
  };
  const imgbbKey = "d12c2e4a8650157b2b6b9fe85336ea43";

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const adminEmails = ["zaradigitalseva@gmail.com","secondadmin@gmail.com"];

  const membersContainer = document.getElementById("members");
  const memberForm = document.getElementById("memberForm");
  const msg = document.getElementById("msg");

  // Load Members
  function loadMembers() {
    db.collection("members").orderBy("name").onSnapshot(snapshot => {
      membersContainer.innerHTML = "";
      snapshot.forEach(doc => {
        let m = doc.data();
        let card = document.createElement("div");
        card.className = "member-card";

        let img = document.createElement("img");
        img.src = m.photo;
        img.alt = m.name;

        let span = document.createElement("span");
        span.textContent = m.name;

        card.appendChild(img);
        card.appendChild(span);

        auth.onAuthStateChanged(user => {
          if (user && adminEmails.includes(user.email)) {
            let editBtn = document.createElement("button");
            editBtn.textContent = "âœï¸ Edit";
            editBtn.className = "edit-btn";
            editBtn.onclick = () => editMember(doc.id, m.name);

            let delBtn = document.createElement("button");
            delBtn.textContent = "ğŸ—‘ Delete";
            delBtn.className = "delete-btn";
            delBtn.onclick = () => deleteMember(doc.id);

            card.appendChild(editBtn);
            card.appendChild(delBtn);
          }
        });

        membersContainer.appendChild(card);
      });
    });
  }
  loadMembers();

  // Login Check
  auth.onAuthStateChanged(user => {
    if (user) {
      if (adminEmails.includes(user.email)) {
        memberForm.style.display = "block";
        msg.innerText = "";
      } else {
        memberForm.style.display = "none";
        msg.innerText = "à¤†à¤ª à¤­à¥€ à¤œà¥à¤¡à¤¼à¥‡à¤‚ à¤†à¤œ à¤¹à¥€ à¤”à¤° à¤…à¤­à¥€à¥¤";
      }
    } else {
      // Auto-login nahi, sirf check
      msg.innerText = "";
    }
  });

  async function uploadToImgbb(file) {
    const formData = new FormData();
    formData.append("image", file);
    try {
      const response = await fetch(`https://api.imgbb.com/1/upload?key=${imgbbKey}`, {
        method: "POST",
        body: formData,
        headers: { Accept: "application/json" }
      });
      const result = await response.json();
      if (!result.success) {
        alert("âŒ Image upload failed. Please try again.");
        return null;
      }
      return result.data.url;
    } catch (err) {
      alert("âš ï¸ Network issue: Unable to upload image.");
      return null;
    }
  }

  async function addMember() {
    let name = document.getElementById("name").value.trim();
    let file = document.getElementById("photoFile").files[0];
    if(!file){ alert("à¤•à¥ƒà¤ªà¤¯à¤¾ à¤«à¥‹à¤Ÿà¥‹ à¤šà¥à¤¨à¥‡à¤‚"); return; }

    const photoUrl = await uploadToImgbb(file);
    if(!photoUrl) return;

    db.collection("members").add({ name, photo: photoUrl })
      .then(()=> document.getElementById("memberForm").reset())
      .catch(err=>alert("Error: "+err.message));
  }

  function editMember(id, oldName){
    let newName = prompt("Update Name:", oldName);
    if(!newName) return;
    db.collection("members").doc(id).update({name: newName})
      .then(()=>alert("âœ… Name updated!"))
      .catch(err=>alert("Error: "+err.message));
  }

  function deleteMember(id){
    if(confirm("Are you sure you want to delete this member?")){
      db.collection("members").doc(id).delete()
        .then(()=>alert("âœ… Member deleted!"))
        .catch(err=>alert("Error: "+err.message));
    }
  }
</script>

<a href="https://all-madrsa.netlify.app/upi" class="donate-btn">ğŸ’ Donate</a>
</body>
</html>
