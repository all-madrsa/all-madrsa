<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ’ Donate | Talimi Ittehad</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .title-3d{font-weight:700;font-size:1.5rem;color:#fff;text-shadow:0 0 6px rgba(0,0,0,.8);}
    .btn-3d{background:linear-gradient(135deg,#4f46e5,#9333ea);color:#fff;padding:.5rem 1rem;border-radius:.5rem;box-shadow:0 3px 6px rgba(0,0,0,.3);transition:.2s;}
    .btn-3d:hover{transform:translateY(-2px);box-shadow:0 5px 10px rgba(0,0,0,.4);}
    .card-3d{background:#fff;border-radius:.8rem;padding:1rem;box-shadow:0 6px 14px rgba(0,0,0,.15);}
    .modal{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:1000;}
    .modal-content{background:#fff;padding:1.5rem;border-radius:.8rem;box-shadow:0 10px 25px rgba(0,0,0,.4);max-width:400px;text-align:center;animation:zoomIn .4s ease;}
    @keyframes zoomIn{from{transform:scale(0.6);opacity:0;}to{transform:scale(1);opacity:1;}}
  </style>
</head>
<body class="bg-slate-50 min-h-screen">

<!-- Header -->
<header class="bg-gradient-to-r from-purple-700 via-pink-600 to-yellow-500 shadow sticky top-0 z-40">
  <div class="max-w-5xl mx-auto px-3 py-3 flex items-center justify-between">
    <a href="index.html" class="title-3d">Talimi Ittehad</a>
    <nav class="flex gap-2 text-sm text-white">
      <a href="index.html">ğŸ  Home</a>
      <a href="donate.html" class="font-bold underline">ğŸ’ Doner </a>
    </nav>
  </div>
</header>

<!-- Main -->
<main class="max-w-2xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">ğŸ’ Support with Donation</h1>

  <!-- Donation Form -->
  <div class="card-3d mb-6">
    <h2 class="font-semibold mb-2">Fill your details</h2>
    <form id="donationForm" class="flex flex-col gap-3">
      <input type="text" id="name" placeholder="ğŸ‘¤ Your Name" class="border p-2 rounded" required />
      <input type="text" id="address" placeholder="ğŸ  Your Address" class="border p-2 rounded" required />
      <input type="number" id="amount" placeholder="ğŸ’° Amount (â‚¹)" class="border p-2 rounded" required />

      <!-- QR + UPI -->
      <div class="text-center">
        <p class="mb-2">ğŸ“² Pay on UPI No. 8806940156 (Scan QR or Copy ID)</p>
        <img id="qrImg" src="" class="mx-auto w-48 h-48 border rounded shadow mb-2" alt="QR Code" />
        <p id="upiText" class="font-bold text-lg text-indigo-700"></p>
        <div class="flex flex-col sm:flex-row justify-center gap-2 mt-2">
          <button type="button" id="copyUpiBtn" class="btn-3d">ğŸ“‹ Copy UPI ID</button>
          <button type="button" id="downloadQrBtn" class="btn-3d">ğŸ“¥ Download QR</button>
          <button type="button" id="payWithUpiBtn" class="btn-3d bg-green-600">âš¡ Pay with UPI</button>
        </div>
      </div>

      <!-- Screenshot Upload -->
      <div>
        <label class="block font-medium mb-1">ğŸ“¸ Upload Payment Screenshot</label>
        <input type="file" id="screenshot" accept="image/*" class="border p-2 rounded w-full" required />
      </div>

      <button type="submit" id="submitBtn" class="btn-3d">ğŸš€ Submit Donation</button>
    </form>
  </div>

  <!-- User Donation List -->
  <div id="userDonationsList" class="card-3d mb-6 hidden"></div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="card-3d hidden">
    <h2 class="font-bold text-lg mb-3">ğŸ‘‘ Admin - Donations List</h2>
    <div id="donationsList" class="space-y-3 mb-6"></div>

    <!-- QR + UPI Management -->
    <h2 class="font-bold text-lg mb-2">ğŸ”‘ Manage QR & UPI</h2>
    <input type="file" id="qrUpload" accept="image/*" class="border p-2 rounded w-full mb-2" />
    <input type="text" id="upiInput" placeholder="Enter UPI ID" class="border p-2 rounded w-full mb-2" />
    <div class="flex gap-2">
      <button id="uploadQRBtn" class="btn-3d">â¬† Update</button>
      <button id="deleteQRBtn" class="btn-3d bg-red-600">ğŸ—‘ Delete</button>
    </div>
  </div>
</main>

<!-- Footer -->
<footer class="bg-gray-100 text-center py-4 mt-10">
  <p class="text-xs text-gray-500">Â© 2025 Talimi Ittehad</p>
</footer>

<!-- Modal Popup -->
<div id="thankyouModal" class="modal hidden">
  <div class="modal-content">
    <h2 class="text-xl font-bold mb-2">âœ… Payment Verified</h2>
    <p>à¤…à¤¸à¥à¤¸à¤²à¤¾à¤® à¤…à¤²à¥ˆà¤•à¥à¤®<br/>à¤¤à¤¾à¤²à¥€à¤®à¥€ à¤‡à¤¤à¥à¤¤à¥‡à¤¹à¤¾à¤¦ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¦à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤®à¤¦à¤¦ à¤®à¤¿à¤² à¤—à¤¯à¤¾ à¤¹à¥ˆ ğŸ‘ ğŸ¤²</p>
    <button id="closeModal" class="btn-3d mt-4">âŒ Close</button>
  </div>
</div>

<!-- Loud Notification Sound -->
<audio id="notifySound" src="https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg" preload="auto"></audio>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
  import { getFirestore, collection, addDoc, query, where, updateDoc, deleteDoc, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";
  import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-auth.js";

  // --- Firebase Config ---
  const firebaseConfig = {
    apiKey: "AIzaSyDMvkPqFKDjrMaLlBkercBYoLxEs1GEbng",
    authDomain: "all-madrsa.firebaseapp.com",
    databaseURL: "https://all-madrsa-default-rtdb.firebaseio.com",
    projectId: "all-madrsa",
    storageBucket: "all-madrsa.appspot.com",
    messagingSenderId: "619313835874",
    appId: "1:619313835874:web:e387e1297663f11fc2463b"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // --- Config ---
  const ADMIN_EMAIL = "zaradigitalseva@gmail.com";
  const IMGBB_KEY = "d12c2e4a8650157b2b6b9fe85336ea43"; 

  // DOM Elements
  const qrImg=document.getElementById("qrImg");
  const upiText=document.getElementById("upiText");
  const copyUpiBtn=document.getElementById("copyUpiBtn");
  const downloadQrBtn=document.getElementById("downloadQrBtn");
  const payWithUpiBtn=document.getElementById("payWithUpiBtn");

  // --- Download QR ---
  downloadQrBtn.onclick=()=>{
    if(qrImg.src){
      const link=document.createElement("a");
      link.href=qrImg.src;
      link.download="upi-qr.png";
      link.click();
    }
  };

  // --- Copy UPI ---
  copyUpiBtn.onclick=()=>{
    if(upiText.textContent){
      navigator.clipboard.writeText(upiText.textContent);
      alert("ğŸ“‹ Copied: "+upiText.textContent);
    }
  };

  // --- Pay with UPI ---
  payWithUpiBtn.onclick=()=>{
    const upiId=upiText.textContent.trim();
    const amount=document.getElementById("amount").value || "";
    if(!upiId){ return alert("UPI ID not available!"); }

    // create deep link
    let upiLink=`upi://pay?pa=${upiId}&pn=Talimi%20Ittehad&cu=INR`;
    if(amount) upiLink+=`&am=${amount}`;

    window.location.href=upiLink;
  };

  // ğŸ”¥ à¤¬à¤¾à¤•à¥€ JS (Auth, liveQR, submit donation, admin verify/delete) same à¤°à¤¹à¥‡à¤—à¤¾ ğŸ”¥
</script>
</body>
</html>
